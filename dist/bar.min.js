define(function(require){"use strict";var d3=require("d3");return function(){function exports(_selection){_selection.each(function(_data){chartWidth=width-margin.left-margin.right,chartHeight=height-margin.top-margin.bottom,data=_data,buildScales(),buildAxis(),buildSVG(this),drawBars(),drawAxis()})}function buildAxis(){xAxis=d3.axisBottom(xScale),yAxis=d3.axisLeft(yScale).ticks(10,"%")}function buildContainerGroups(){var container=svg.append("g").classed("container-group",!0).attr("transform","translate("+margin.left+","+margin.top+")");container.append("g").classed("chart-group",!0),container.append("g").classed("x-axis-group axis",!0),container.append("g").classed("y-axis-group axis",!0)}function buildScales(){xScale=d3.scaleBand().rangeRound([0,chartWidth]).padding(.1).domain(data.map(getLetter)),yScale=d3.scaleLinear().rangeRound([chartHeight,0]).domain([0,d3.max(data,getFrequency)])}function buildSVG(container){svg||(svg=d3.select(container).append("svg").classed("bar-chart",!0),buildContainerGroups()),svg.transition().attr("width",width).attr("height",height)}function drawAxis(){svg.select(".x-axis-group.axis").attr("transform","translate(0,"+chartHeight+")").call(xAxis),svg.select(".y-axis-group.axis").call(yAxis)}function drawBars(){var bars=svg.select(".chart-group").selectAll(".bar").data(data);bars.enter().append("rect").classed("bar",!0).attr("x",function(d){return xScale(d.letter)}).attr("y",function(d){return yScale(d.frequency)}).attr("width",xScale.bandwidth()).attr("height",function(d){return chartHeight-yScale(d.frequency)}).on("mouseover",function(){dispatcher.call("customMouseOver",this)}),bars.exit().style("opacity",0).remove()}var data,chartWidth,chartHeight,xScale,yScale,xAxis,yAxis,svg,margin={top:20,right:20,bottom:30,left:40},width=960,height=500,dispatcher=d3.dispatch("customMouseOver"),getLetter=function(d){return d.letter},getFrequency=function(d){return d.frequency};return exports.margin=function(_x){return arguments.length?(margin=_x,this):margin},exports.width=function(_x){return arguments.length?(width=_x,this):width},exports.height=function(_x){return arguments.length?(height=_x,this):height},exports.on=function(){var value=dispatcher.on.apply(dispatcher,arguments);return value===dispatcher?exports:value},exports}});